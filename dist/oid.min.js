(function(t,e){if(typeof exports==="object"&&typeof module==="object"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else if(typeof exports==="object"){exports["ObjectId"]=e()}else{t["ObjectId"]=e()}})(this,function(){"use strict";var i=Uint8Array.prototype.toString;Uint8Array.prototype.toString=function(t){if(t==="hex"){var e="";for(var r=0;r<this.length;r++){var n=this[r].toString(16);e+=n.length===1?"0"+n:n}return e}else if(t==="binary"){var e="";for(var r=0;r<this.length;r++){e+=String.fromCharCode(this[r])}return e}else{return i.call(this)}};function t(t){var e=new Uint8Array(t);for(var r=0;r<t;++r)e[r]=Math.floor(Math.random()*256);return e}var e=t;if(typeof window!=="undefined"&&window.crypto&&window.crypto.getRandomValues){e=function(t){return window.crypto.getRandomValues(new Uint8Array(t))}}else{var r;try{var n="crypto";if(typeof __non_webpack_require__!=="undefined"){r=__non_webpack_require__(n)}else{r=require(n)}e=r.randomBytes}catch(t){}if(e==null){e=t}}function o(e,r){return function(){console.warn(r);var t=Array.prototype.slice.call(arguments);return e.apply(this,t)}}var a=e(5);var s=new RegExp("^[0-9a-fA-F]{24}$");var f=[];for(var u=0;u<256;u++){f[u]=(u<=15?"0":"")+u.toString(16)}var c=[];var u=0;while(u<10)c[48+u]=u++;while(u<16)c[65-10+u]=c[97-10+u]=u++;function h(t){return t.toString("hex")}function d(t,e){var r=t[e];return new TypeError('ObjectId string "'+t+'" contains invalid character "'+r+'" with character code ('+t.charCodeAt(e)+"). All character codes for a non-hex string must be less than 256.")}function g(t){if(t instanceof g)return t;if(t==null||typeof t==="number"){this.id=g.generate(t);if(g.cacheHexString)this.__id=this.toString("hex");return}var e=g.isValid(t);if(!e&&t!=null){throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}else if(e&&typeof t==="string"&&t.length===24){return g.createFromHexString(t)}else if(t!=null&&t.length===12){if(Array.isArray(t)||t instanceof Uint8Array){this.id=Uint8Array.from(t)}else{this.id=t}}else if(t!=null&&t.toHexString){return g.createFromHexString(t.toHexString())}else{throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}if(g.cacheHexString)this.__id=this.toString("hex")}g.prototype.toHexString=function(){if(g.cacheHexString&&this.__id)return this.__id;var t="";if(!this.id||!this.id.length){throw new TypeError("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]")}if(this.id instanceof Uint8Array){t=h(this.id);if(g.cacheHexString)this.__id=t;return t}for(var e=0;e<this.id.length;e++){var r=f[this.id.charCodeAt(e)];if(typeof r!=="string"){throw d(this.id,e)}t+=r}if(g.cacheHexString)this.__id=t;return t};g.getInc=function(){return g.index=(g.index+1)%16777215};g.generate=function(t){if("number"!==typeof t){t=~~(Date.now()/1e3)}var e=g.getInc();var r=new Uint8Array(12);r[3]=t&255;r[2]=t>>8&255;r[1]=t>>16&255;r[0]=t>>24&255;r[4]=a[0];r[5]=a[1];r[6]=a[2];r[7]=a[3];r[8]=a[4];r[11]=e&255;r[10]=e>>8&255;r[9]=e>>16&255;return r};g.prototype.toString=function(t){if(this.id instanceof Uint8Array){return this.id.toString(typeof t==="string"?t:"hex")}return this.toHexString()};g.prototype.toJSON=function(){return this.toHexString()};g.prototype.equals=function(t){if(t instanceof g){return this.toString()===t.toString()}if(typeof t==="string"&&g.isValid(t)&&t.length===12&&this.id instanceof Uint8Array){return t===this.id.toString("binary")}if(typeof t==="string"&&g.isValid(t)&&t.length===24){return t.toLowerCase()===this.toHexString()}if(typeof t==="string"&&g.isValid(t)&&t.length===12){return t===this.id}if(t!=null&&(t instanceof g||t.toHexString)){return t.toHexString()===this.toHexString()}return false};g.prototype.getTimestamp=function(){var t=new Date;var e=this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24;t.setTime(Math.floor(e)*1e3);return t};g.createPk=function(){return new g};g.createFromTime=function(t){var e=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0]);e[3]=t&255;e[2]=t>>8&255;e[1]=t>>16&255;e[0]=t>>24&255;return new g(e)};g.createFromHexString=function(t){if(typeof t==="undefined"||t!=null&&t.length!==24){throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}var e=new Uint8Array(12);var r=0;var n=0;while(n<24){e[r++]=c[t.charCodeAt(n++)]<<4|c[t.charCodeAt(n++)]}return new g(e)};g.isValid=function(t){if(t==null)return false;if(typeof t==="number"){return true}if(typeof t==="string"){return t.length===12||t.length===24&&s.test(t)}if(t instanceof g){return true}if(t instanceof Uint8Array||Array.isArray(t)&&t.length===12){return true}if(t.toHexString){return t.id.length===12||t.id.length===24&&s.test(t.id)}return false};g.prototype.toExtendedJSON=function(){if(this.toHexString)return{$oid:this.toHexString()};return{$oid:this.toString("hex")}};g.fromExtendedJSON=function(t){return new g(t.$oid)};g.get_inc=o(function(){return g.getInc()},"Please use the static `ObjectId.getInc()` instead");g.prototype.get_inc=o(function(){return g.getInc()},"Please use the static `ObjectId.getInc()` instead");g.prototype.getInc=o(function(){return g.getInc()},"Please use the static `ObjectId.getInc()` instead");g.prototype.generate=o(function(t){return g.generate(t)},"Please use the static `ObjectId.generate(time)` instead");Object.defineProperty(g.prototype,"generationTime",{enumerable:true,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(t){this.id[3]=t&255;this.id[2]=t>>8&255;this.id[1]=t>>16&255;this.id[0]=t>>24&255}});var l="util";var p;try{if(typeof __non_webpack_require__!=="undefined"){p=__non_webpack_require__(l)}else{p=require(l)}g.prototype[p.inspect.custom]=g.prototype.toString}catch(t){g.prototype["inspect"]=g.prototype.toString}g.index=~~(Math.random()*16777215);Object.defineProperty(g.prototype,"_bsontype",{value:"ObjectID"});return g});