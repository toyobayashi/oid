!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).oid={})}(this,(function(t){"use strict";var e,r;e="undefined"!=typeof __webpack_modules__||"undefined"!=typeof __webpack_modules__?"undefined"!=typeof __non_webpack_require__?__non_webpack_require__:undefined:"undefined"!=typeof require?require:undefined;try{r=e("buffer").Buffer}catch(S){}var n=Object.prototype.toString;function i(t){return"undefined"!=typeof Uint8Array&&t instanceof Uint8Array||function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n.call(t)}(t)}function o(t){if(r)return r.alloc(t);var e;if("undefined"!=typeof Uint8Array)return new Uint8Array(t);var n=[];for(e=0;e<t;e++)n[e]=0;return n}function a(t){if(t=t||0,r&&r.isBuffer(this))return this.readUInt32BE(t);var e=this[t],n=this[t+3];if(e===undefined||n===undefined)throw new RangeError("Attempt to write outside buffer bounds");return e*Math.pow(2,24)+this[++t]*Math.pow(2,16)+this[++t]*Math.pow(2,8)+n}function s(t){if(r)return r.from(this).toString(t);var e,n,i,o,a,s="",f=0;if("hex"===t){for(s="",f=0;f<this.length;f++){var c=this[f].toString(16);s+=1===c.length?"0"+c:c}return s}if("binary"===t){for(s="",f=0;f<this.length;f++)s+=String.fromCharCode(this[f]);return s}for(e="",n=this.length,f=0;f<n;)switch((i=this[f++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(i);break;case 12:case 13:o=this[f++],e+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=this[f++],a=this[f++],e+=String.fromCharCode((15&i)<<12|(63&o)<<6|(63&a)<<0)}return e}function f(t){for(var e=o(t),r=0;r<t;++r)e[r]=Math.floor(256*Math.random());return e}var c=f;if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues&&"undefined"!=typeof Uint8Array)c=function(t){return window.crypto.getRandomValues(new Uint8Array(t))};else{try{c=e("crypto").randomBytes}catch(S){}null==c&&(c=f)}function u(t,e){return function(){console.warn(e);var r=Array.prototype.slice.call(arguments);return t.apply(this,r)}}var h,d=c(5),g=new RegExp("^[0-9a-fA-F]{24}$"),p=[];for(h=0;h<256;h++)p[h]=(h<=15?"0":"")+h.toString(16);var l,y=[];for(h=0;h<10;)y[48+h]=h++;for(;h<16;)y[55+h]=y[87+h]=h++;function b(t){if(!(this instanceof b))throw new TypeError("Class constructor ObjectId cannot be invoked without 'new'");if(t instanceof b)return t;if(null==t||"number"==typeof t)return this.id=b.generate(t),void(b.cacheHexString&&(this.__id=this.toString("hex")));var e=b.isValid(t);if(!e&&null!=t)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(e&&"string"==typeof t&&24===t.length&&r)return new b(r.from(t,"hex"));if(e&&"string"==typeof t&&24===t.length)return b.createFromHexString(t);if(null==t||12!==t.length){if(null!=t&&t.toHexString)return b.createFromHexString(t.toHexString());throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}i(t)?this.id=function(t){if(r)return r.from(t);var e;if("undefined"!=typeof Uint8Array){if("function"==typeof Uint8Array.from)return Uint8Array.from(t);var n=new Uint8Array(t.length);for(e=0;e<t.length;e++)n[e]=t[e];return n}var i=[];for(e=0;e<t.length;e++)i[e]=t[e];return i}(t):this.id=t,b.cacheHexString&&(this.__id=this.toString("hex"))}b.prototype.toHexString=function(){if(b.cacheHexString&&this.__id)return this.__id;var t,e,r,n,o="";if(!this.id||!this.id.length)throw new TypeError("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]");if(i(this.id))return t=this.id,o=s.call(t,"hex"),b.cacheHexString&&(this.__id=o),o;for(var a=0;a<this.id.length;a++){var f=p[this.id.charCodeAt(a)];if("string"!=typeof f)throw e=this.id,n=void 0,n=e[r=a],new TypeError('ObjectId string "'+e+'" contains invalid character "'+n+'" with character code ('+e.charCodeAt(r)+"). All character codes for a non-hex string must be less than 256.");o+=f}return b.cacheHexString&&(this.__id=o),o},b.getInc=function(){return b.index=(b.index+1)%16777215},b.generate=function(t){"number"!=typeof t&&(t=~~(Date.now()/1e3));var e=b.getInc(),r=o(12);return r[3]=255&t,r[2]=t>>8&255,r[1]=t>>16&255,r[0]=t>>24&255,r[4]=d[0],r[5]=d[1],r[6]=d[2],r[7]=d[3],r[8]=d[4],r[11]=255&e,r[10]=e>>8&255,r[9]=e>>16&255,r},b.prototype.toString=function(t){return i(this.id)?s.call(this.id,"string"==typeof t?t:"hex"):this.toHexString()},b.prototype.toJSON=function(){return this.toHexString()},b.prototype.equals=function(t){return t instanceof b?this.toString()===t.toString():"string"==typeof t&&b.isValid(t)&&12===t.length&&i(this.id)?t===s.call(this.id,"binary"):"string"==typeof t&&b.isValid(t)&&24===t.length?t.toLowerCase()===this.toHexString():"string"==typeof t&&b.isValid(t)&&12===t.length?t===this.id:!(null==t||!(t instanceof b||t.toHexString))&&t.toHexString()===this.toHexString()},b.prototype.getTimestamp=function(){var t=new Date,e=a.call(this.id,0);return t.setTime(1e3*Math.floor(e)),t},b.createPk=function(){return new b},b.createFromTime=function(t){var e=o(12);return e[3]=255&t,e[2]=t>>8&255,e[1]=t>>16&255,e[0]=t>>24&255,new b(e)},b.createFromHexString=function(t){if(void 0===t||null!=t&&24!==t.length)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");for(var e=o(12),r=0,n=0;n<24;)e[r++]=y[t.charCodeAt(n++)]<<4|y[t.charCodeAt(n++)];return new b(e)},b.isValid=function(t){return null!=t&&("number"==typeof t||("string"==typeof t?12===t.length||24===t.length&&g.test(t):t instanceof b||(!(!i(t)||12!==t.length)||!!t.toHexString&&(12===t.id.length||24===t.id.length&&g.test(t.id)))))},b.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},b.fromExtendedJSON=function(t){return new b(t.$oid)},b.get_inc=u((function(){return b.getInc()}),"Please use the static `ObjectId.getInc()` instead"),b.prototype.get_inc=u((function(){return b.getInc()}),"Please use the static `ObjectId.getInc()` instead"),b.prototype.getInc=u((function(){return b.getInc()}),"Please use the static `ObjectId.getInc()` instead"),b.prototype.generate=u((function(t){return b.generate(t)}),"Please use the static `ObjectId.generate(time)` instead");try{Object.defineProperty(b.prototype,"generationTime",{enumerable:!0,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(t){this.id[3]=255&t,this.id[2]=t>>8&255,this.id[1]=t>>16&255,this.id[0]=t>>24&255}})}catch(x){b.prototype.generationTime=0}try{l=e("util"),b.prototype[l.inspect.custom||"inspect"]=b.prototype.toString}catch(S){b.prototype.inspect=b.prototype.toString}b.index=~~(16777215*Math.random());try{Object.defineProperty(b.prototype,"_bsontype",{value:"ObjectID"})}catch(x){b.prototype._bsontype="ObjectID"}var w=b,m={ObjectId:w};t.ObjectId=w,t["default"]=m,(function(){try{return Object.defineProperty(t,"__esModule",{value:!0})}catch(_){return t.__esModule=!0,t}})()}));
