(function(t,e){if(typeof exports==="object"&&typeof module==="object"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else if(typeof exports==="object"){exports["ObjectId"]=e()}else{t["ObjectId"]=e()}})(this,function(){"use strict";function t(t){var e;if(typeof __webpack_require__!=="undefined"){e=typeof __non_webpack_require__!=="undefined"&&typeof wx==="undefined"?__non_webpack_require__:undefined}else{e=typeof require!=="undefined"&&typeof wx==="undefined"?require:undefined}return e(t)}var u;try{u=t("buffer").Buffer}catch(S){}var e=Object.prototype.toString;function r(t){if(Array.isArray){return Array.isArray(t)}return e.call(t)==="[object Array]"}function n(t){return typeof Uint8Array!=="undefined"&&t instanceof Uint8Array||r(t)}function i(t){if(u){return u.alloc(t)}var e;if(typeof Uint8Array!=="undefined"){return new Uint8Array(t)}var r=[];for(e=0;e<t;e++){r[e]=0}return r}function o(t){if(u){return u.from(t)}var e;if(typeof Uint8Array!=="undefined"){if(typeof Uint8Array.from==="function"){return Uint8Array.from(t)}else{var r=new Uint8Array(t.length);for(e=0;e<t.length;e++){r[e]=t[e]}return r}}var n=[];for(e=0;e<t.length;e++){n[e]=t[e]}return n}function a(t){t=t||0;if(u&&u.isBuffer(this)){return this.readUInt32BE(t)}var e=this[t];var r=this[t+3];if(e===undefined||r===undefined){throw new RangeError("Attempt to write outside buffer bounds")}return e*Math.pow(2,24)+this[++t]*Math.pow(2,16)+this[++t]*Math.pow(2,8)+r}function s(t){if(u){return u.from(this).toString(t)}var e="";var r=0;if(t==="hex"){e="";for(r=0;r<this.length;r++){var n=this[r].toString(16);e+=n.length===1?"0"+n:n}return e}else if(t==="binary"){e="";for(r=0;r<this.length;r++){e+=String.fromCharCode(this[r])}return e}else{var i,o,a;var s,f;i="";o=this.length;r=0;while(r<o){a=this[r++];switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=String.fromCharCode(a);break;case 12:case 13:s=this[r++];i+=String.fromCharCode((a&31)<<6|s&63);break;case 14:s=this[r++];f=this[r++];i+=String.fromCharCode((a&15)<<12|(s&63)<<6|(f&63)<<0);break}}return i}}function f(t){var e=i(t);for(var r=0;r<t;++r)e[r]=Math.floor(Math.random()*256);return e}var c=f;if(typeof window!=="undefined"&&window.crypto&&window.crypto.getRandomValues&&typeof Uint8Array!=="undefined"){c=function(t){return window.crypto.getRandomValues(new Uint8Array(t))}}else{var h;try{h=t("crypto");c=h.randomBytes}catch(S){}if(c==null){c=f}}function d(e,r){return function(){console.warn(r);var t=Array.prototype.slice.call(arguments);return e.apply(this,t)}}var g=c(5);var l=new RegExp("^[0-9a-fA-F]{24}$");var p=[];var y;for(y=0;y<256;y++){p[y]=(y<=15?"0":"")+y.toString(16)}var w=[];y=0;while(y<10)w[48+y]=y++;while(y<16)w[65-10+y]=w[97-10+y]=y++;function b(t){return s.call(t,"hex")}function m(t,e){var r=t[e];return new TypeError('ObjectId string "'+t+'" contains invalid character "'+r+'" with character code ('+t.charCodeAt(e)+"). All character codes for a non-hex string must be less than 256.")}function v(t){if(!(this instanceof v))throw new TypeError("Class constructor ObjectId cannot be invoked without 'new'");if(t instanceof v)return t;if(t==null||typeof t==="number"){this.id=v.generate(t);if(v.cacheHexString)this.__id=this.toString("hex");return}var e=v.isValid(t);if(!e&&t!=null){throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}else if(e&&typeof t==="string"&&t.length===24&&u){return new v(u.from(t,"hex"))}else if(e&&typeof t==="string"&&t.length===24){return v.createFromHexString(t)}else if(t!=null&&t.length===12){if(n(t)){this.id=o(t)}else{this.id=t}}else if(t!=null&&t.toHexString){return v.createFromHexString(t.toHexString())}else{throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}if(v.cacheHexString)this.__id=this.toString("hex")}v.prototype.toHexString=function(){if(v.cacheHexString&&this.__id)return this.__id;var t="";if(!this.id||!this.id.length){throw new TypeError("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]")}if(n(this.id)){t=b(this.id);if(v.cacheHexString)this.__id=t;return t}for(var e=0;e<this.id.length;e++){var r=p[this.id.charCodeAt(e)];if(typeof r!=="string"){throw m(this.id,e)}t+=r}if(v.cacheHexString)this.__id=t;return t};v.getInc=function(){return v.index=(v.index+1)%16777215};v.generate=function(t){if("number"!==typeof t){t=~~(Date.now()/1e3)}var e=v.getInc();var r=i(12);r[3]=t&255;r[2]=t>>8&255;r[1]=t>>16&255;r[0]=t>>24&255;r[4]=g[0];r[5]=g[1];r[6]=g[2];r[7]=g[3];r[8]=g[4];r[11]=e&255;r[10]=e>>8&255;r[9]=e>>16&255;return r};v.prototype.toString=function(t){if(n(this.id)){return s.call(this.id,typeof t==="string"?t:"hex")}return this.toHexString()};v.prototype.toJSON=function(){return this.toHexString()};v.prototype.equals=function(t){if(t instanceof v){return this.toString()===t.toString()}if(typeof t==="string"&&v.isValid(t)&&t.length===12&&n(this.id)){return t===s.call(this.id,"binary")}if(typeof t==="string"&&v.isValid(t)&&t.length===24){return t.toLowerCase()===this.toHexString()}if(typeof t==="string"&&v.isValid(t)&&t.length===12){return t===this.id}if(t!=null&&(t instanceof v||t.toHexString)){return t.toHexString()===this.toHexString()}return false};v.prototype.getTimestamp=function(){var t=new Date;var e=a.call(this.id,0);t.setTime(Math.floor(e)*1e3);return t};v.createPk=function(){return new v};v.createFromTime=function(t){var e=i(12);e[3]=t&255;e[2]=t>>8&255;e[1]=t>>16&255;e[0]=t>>24&255;return new v(e)};v.createFromHexString=function(t){if(typeof t==="undefined"||t!=null&&t.length!==24){throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}var e=i(12);var r=0;var n=0;while(n<24){e[r++]=w[t.charCodeAt(n++)]<<4|w[t.charCodeAt(n++)]}return new v(e)};v.isValid=function(t){if(t==null)return false;if(typeof t==="number"){return true}if(typeof t==="string"){return t.length===12||t.length===24&&l.test(t)}if(t instanceof v){return true}if(n(t)&&t.length===12){return true}if(t.toHexString){return t.id.length===12||t.id.length===24&&l.test(t.id)}return false};v.prototype.toExtendedJSON=function(){if(this.toHexString)return{$oid:this.toHexString()};return{$oid:this.toString("hex")}};v.fromExtendedJSON=function(t){return new v(t.$oid)};v.get_inc=d(function(){return v.getInc()},"Please use the static `ObjectId.getInc()` instead");v.prototype.get_inc=d(function(){return v.getInc()},"Please use the static `ObjectId.getInc()` instead");v.prototype.getInc=d(function(){return v.getInc()},"Please use the static `ObjectId.getInc()` instead");v.prototype.generate=d(function(t){return v.generate(t)},"Please use the static `ObjectId.generate(time)` instead");try{Object.defineProperty(v.prototype,"generationTime",{enumerable:true,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(t){this.id[3]=t&255;this.id[2]=t>>8&255;this.id[1]=t>>16&255;this.id[0]=t>>24&255}})}catch(_){v.prototype.generationTime=0}var x;try{x=t("util");v.prototype[x.inspect.custom||"inspect"]=v.prototype.toString}catch(S){v.prototype.inspect=v.prototype.toString}v.index=~~(Math.random()*16777215);try{Object.defineProperty(v.prototype,"_bsontype",{value:"ObjectID"})}catch(_){v.prototype._bsontype="ObjectID"}return v});